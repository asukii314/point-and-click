(this["webpackJsonproom-escape"]=this["webpackJsonproom-escape"]||[]).push([[0],{28:function(t,e,n){},38:function(t,e,n){},39:function(t,e,n){"use strict";n.r(e);var a=n(9),i=n.n(a),s=n(22),o=n.n(s),r=(n(28),n(17)),c=n(8),l=n(3),d=n(4),u=n(6),h=n(5),b=n(14),j=n(11),m=n(10),p=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){var t;return Object(l.a)(this,n),(t=e.call(this)).dragStartHandler=function(e){t.setState(Object(c.a)(Object(c.a)({},t.state),{},{lastInvCoords:{x:e.target.attrs.x,y:e.target.attrs.y}}))},t.dragEndHandler=function(e,n){var a=t.refs[e.id].parent;t.refs[e.id].position(t.state.lastInvCoords),t.props.onDragEnd(e.interactions.filter((function(t){return"drag"===t.type})),n.evt.clientX,n.evt.clientY),a.draw()},t.renderInventorySlot=function(t,e){return Object(m.jsx)(b.e,{x:5+e%10*50,y:515+50*Math.floor(e/10),width:40,height:40,fill:"grey",shadowBlur:10,shadowOpacity:.4},e)},t.renderInventoryItem=function(e,n){return Object(m.jsx)(b.b,{ref:e.id,x:5+n%10*50,y:515+50*Math.floor(n/10),width:40,height:40,image:e.image,draggable:!0,onMouseDown:t.dragStartHandler,onDragEnd:t.dragEndHandler.bind(Object(j.a)(t),e),onClick:t.props.onClick.bind(Object(j.a)(t),e)},e.id)},t.state={lastInvCoords:{x:0,y:0}},t}return Object(d.a)(n,[{key:"render",value:function(){var t;return Object(m.jsxs)(b.c,{className:"inventoryLayer",children:[Object(m.jsx)(b.e,{x:0,y:510,width:500,height:50*Math.ceil(this.props.maxInventorySlots/10),fill:"dimgray",shadowBlur:10}),Object(r.a)(Array(parseInt(this.props.maxInventorySlots)).keys()).map(this.renderInventorySlot),null===(t=this.props.items)||void 0===t?void 0:t.map(this.renderInventoryItem)]})}}]),n}(a.Component),v=n(24),f=n.n(v),O=n.p+"static/media/Room1.bf0f29a2.yaml",g=n(37),y=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){var t;return Object(l.a)(this,n),(t=e.call(this))._clickHandler=function(e,n){t.props.onClick(t.state.items[e]),t.setState((function(t){return Object(c.a)(Object(c.a)({},t),{},{dotX:n.evt.pageX,dotY:n.evt.pageY,lastClicked:e})}))},t._hoverHandler=function(e){t.setState((function(t){return Object(c.a)(Object(c.a)({},t),{},{hoveredItem:e})}))},t._hoverEndHandler=function(e,n){t.setState((function(t){return Object(c.a)(Object(c.a)({},t),{},{hoveredItem:null})}))},t._mouseUpHandler=function(e,n){t.props.onMouseUp(e,n.evt.clientX,n.evt.clientY),t.setState(Object(c.a)(Object(c.a)({},t.state),{},{dotX:n.evt.clientX,dotY:n.evt.clientY}))},t.renderClickableItem=function(e){var n=t.state.items[e];if(n)return Object(m.jsx)(b.d,{points:n.position.points,x:n.position.offsetX,y:n.position.offsetY,opacity:t.state.hoveredItem===e?.2:0,fill:"orange",closed:!0,onClick:t._clickHandler.bind(Object(j.a)(t),e),onMouseover:t._hoverHandler.bind(Object(j.a)(t),e),onMouseleave:t._hoverEndHandler.bind(Object(j.a)(t),e),onMouseUp:t._mouseUpHandler.bind(Object(j.a)(t),e)},e)},t.state={dotX:-10,dotY:-10,lastClicked:"nothing yet",hoveredItem:null,image:null,items:{}},t}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this;g(O).then((function(t){return t.text()})).then((function(e){t.setState((function(t){return Object(c.a)(Object(c.a)({},t),{},{items:f.a.parse(e)})}))}));var e=new window.Image;e.src="images/Room1.png",e.onload=function(){t.setState(Object(c.a)(Object(c.a)({},t.state),{},{image:e}))}}},{key:"render",value:function(){return this.state?Object(m.jsxs)(b.c,{className:"imgLayer",children:[Object(m.jsx)(b.b,{x:0,y:0,width:500,height:500,image:this.state.image}),Object(m.jsx)(b.a,{x:this.state.dotX,y:this.state.dotY,radius:"4",fill:"red"}),Object.keys(this.state.items).map(this.renderClickableItem)]}):null}}]),n}(a.Component),x=(n(38),function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){var t;return Object(l.a)(this,n),(t=e.call(this))._handleHiddenItems=function(e){var n,a=null===(n=e.itemsGained)||void 0===n?void 0:n[0];if(a&&!t.playerHasLooted(a)){var i=new window.Image;return i.src="images/".concat(a.id,".png"),i.onload=function(){t.setState(Object(c.a)(Object(c.a)({},t.state),{},{text:e.text,inventoryItems:[].concat(Object(r.a)(t.state.inventoryItems),[Object(c.a)(Object(c.a)({},a),{},{image:i})])}))},!0}return!1},t.itemClickHandler=function(e){var n,a=!1;null===(n=e.interactions)||void 0===n||n.forEach((function(e){"click"===e.type&&(a=a||t._handleHiddenItems(e))})),a||t.setState(Object(c.a)(Object(c.a)({},t.state),{},{text:e.description}))},t.logLastMouseUp=function(e,n,a){t.setState(Object(c.a)(Object(c.a)({},t.state),{},{lastMouseUp:{itemId:e,x:n,y:a}}))},t.itemDragHandler=function(e,n,a){var i=!1;null===e||void 0===e||e.forEach((function(e){console.log(e),e.target===t.state.lastMouseUp.itemId&&n===t.state.lastMouseUp.x&&a===t.state.lastMouseUp.y&&(t.setState(Object(c.a)(Object(c.a)({},t.state),{},{text:e.text})),i=!0,t._handleHiddenItems(e))})),i||t.setState(Object(c.a)(Object(c.a)({},t.state),{},{text:"Nothing happens."}))},t.state={maxInventorySlots:10,inventoryItems:[],usedItems:[],text:"",lastMouseUp:{itemId:null,x:0,y:0}},t}return Object(d.a)(n,[{key:"playerHasLooted",value:function(t){return this.state.inventoryItems.map((function(t){return t.id})).includes(t.id)||this.state.usedItems.map((function(t){return t.id})).includes(t.id)}},{key:"render",value:function(){return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsxs)(b.f,{className:"canvas",width:"500",height:"1000",children:[Object(m.jsx)(y,{onClick:this.itemClickHandler,onMouseUp:this.logLastMouseUp}),Object(m.jsx)(p,{items:this.state.inventoryItems,maxInventorySlots:this.state.maxInventorySlots,onClick:this.itemClickHandler,onDragEnd:this.itemDragHandler})]}),Object(m.jsx)("header",{className:"App-header",children:this.state.text})]})}}]),n}(a.Component)),I=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,41)).then((function(e){var n=e.getCLS,a=e.getFID,i=e.getFCP,s=e.getLCP,o=e.getTTFB;n(t),a(t),i(t),s(t),o(t)}))};o.a.render(Object(m.jsx)(i.a.StrictMode,{children:Object(m.jsx)(x,{})}),document.getElementById("root")),I()}},[[39,1,2]]]);
//# sourceMappingURL=main.5df5820e.chunk.js.map