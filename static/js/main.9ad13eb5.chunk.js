(this["webpackJsonproom-escape"]=this["webpackJsonproom-escape"]||[]).push([[0],{43:function(t,e,n){},55:function(t,e,n){},61:function(t,e,n){},62:function(t,e,n){"use strict";n.r(e);var i=n(4),a=n.n(i),o=n(30),s=n.n(o),r=(n(43),n(5)),c=n(6),l=n(8),d=n(7),h=n(25),u=n(12),j=n(26),m=n(19),b=n(9),f=n(20),g=n(32),O=n.n(g),p=n(38),v=(n(53),n(11)),x=n(3),y=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(){var t;return Object(r.a)(this,n),(t=e.call(this)).dragStartHandler=function(e){t.setState(Object(b.a)(Object(b.a)({},t.state),{},{lastInvCoords:{x:e.target.attrs.x,y:e.target.attrs.y}}))},t.dragEndHandler=function(e,n){var i=t.refs[e.id].parent;t.refs[e.id].position(t.state.lastInvCoords);var a=t.getInventorySlotForCoords(n.target.getStage().getPointerPosition());null!==a&&t.props.items.length>a?t.props.onCombineItems(e,t.props.items[a]):t.props.onDragEnd(e.interactions,n.target.getStage().getPointerPosition()),i.draw()},t.getInventorySlotForCoords=function(e){var n=e.x,i=e.y,a=Math.ceil((n-5)/50),o=Math.ceil((i-510)/50);if(a<1||a>10||o<1)return null;var s=10*(o-1)+(a-1);return s>=t.props.maxInventorySlots?null:s},t.renderInventorySlot=function(t,e){return Object(x.jsx)(f.e,{x:5+e%10*50,y:515+50*Math.floor(e/10),width:40,height:40,fill:"grey",shadowBlur:10,shadowOpacity:.4},e)},t.renderInventoryItem=function(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e&&(i||n!==t.state.hoveredIdx))return Object(x.jsx)(f.b,{ref:e.id,x:5+n%10*50,y:515+50*Math.floor(n/10),width:40,height:40,image:e.image,draggable:!0,onMouseDown:t.dragStartHandler,onDragStart:t.dragStartHandler,onDragEnd:t.dragEndHandler.bind(Object(v.a)(t),e),onClick:t.props.onClick.bind(Object(v.a)(t),e),onTap:t.props.onClick.bind(Object(v.a)(t),e),onMouseOver:function(){t.setState(Object(b.a)(Object(b.a)({},t.state),{},{hoveredIdx:n}))}},e.id)},t.state={lastInvCoords:{x:0,y:0},hoveredIdx:0},t}return Object(c.a)(n,[{key:"render",value:function(){var t,e=this;return Object(x.jsxs)(f.c,{className:"inventoryLayer",children:[Object(x.jsx)(f.e,{x:0,y:510,width:500,height:50*Math.ceil(this.props.maxInventorySlots/10),fill:"dimgray",shadowBlur:10}),Object(m.a)(Array(parseInt(this.props.maxInventorySlots)).keys()).map(this.renderInventorySlot),null===(t=this.props.items)||void 0===t?void 0:t.map((function(t,n){return e.renderInventoryItem(t,n)})),this.props.items.length>0&&this.renderInventoryItem(this.props.items[this.state.hoveredIdx],this.state.hoveredIdx,!0)]})}}]),n}(i.Component),I=n(36),k=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(){var t;return Object(r.a)(this,n),(t=e.call(this))._clickHandler=function(e,n){var i=n.target.getStage().getPointerPosition();t.props.onClick(t.state.items[e]),t.setState((function(t){return Object(b.a)(Object(b.a)({},t),{},{dotX:i.x,dotY:i.y})}))},t._hoverHandler=function(e){t.setState((function(t){return Object(b.a)(Object(b.a)({},t),{},{hoveredItem:e})}))},t._hoverEndHandler=function(e,n){t.setState((function(t){return Object(b.a)(Object(b.a)({},t),{},{hoveredItem:null})}))},t._mouseUpHandler=function(e,n){var i=n.target.getStage().getPointerPosition();t.props.onMouseUp(e,i),t.setState(Object(b.a)(Object(b.a)({},t.state),{},{dotX:i.x,dotY:i.y}))},t.renderClickableItem=function(e){var n=t.state.items[e];if(n)return Object(x.jsx)(f.d,{points:n.position.points,x:n.position.offsetX,y:n.position.offsetY,opacity:t.state.hoveredItem===e?.2:0,fill:"orange",closed:!0,onClick:function(n){return t._clickHandler(e,n)},onTap:function(n){return t._clickHandler(e,n)},onMouseover:t._hoverHandler.bind(Object(v.a)(t),e),onMouseleave:t._hoverEndHandler.bind(Object(v.a)(t),e),onTouchEnd:t._mouseUpHandler.bind(Object(v.a)(t),e),onMouseUp:t._mouseUpHandler.bind(Object(v.a)(t),e)},e)},t.state={dotX:-10,dotY:-10,hoveredItem:null,image:null,items:{}},t}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var t=this;I(this.props.config).then((function(t){return t.text()})).then((function(e){t.setState((function(t){return Object(b.a)(Object(b.a)({},t),{},{items:O.a.parse(e)})}))}));var e=new window.Image;e.src="images/".concat(this.props.bgImage),e.onload=function(){t.setState(Object(b.a)(Object(b.a)({},t.state),{},{image:e}))}}},{key:"render",value:function(){return this.state?Object(x.jsxs)(f.c,{className:"imgLayer",children:[Object(x.jsx)(f.b,{x:0,y:0,width:500,height:500,image:this.state.image}),Object(x.jsx)(f.a,{x:this.state.dotX,y:this.state.dotY,radius:"4",fill:"red"}),Object.keys(this.state.items).map(this.renderClickableItem)]}):null}}]),n}(i.Component),w=n(36),S=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(t){var i;return Object(r.a)(this,n),(i=e.call(this,t))._handleLostItems=function(t){var e=t.itemsLost;if(!e||0===e.length)return!1;var n=i.state.inventoryItems.filter((function(t){return!e.includes(t.id)}));return i.setState(Object(b.a)(Object(b.a)({},i.state),{},{inventoryItems:n,usedItemIds:[].concat(Object(m.a)(i.state.usedItemIds),Object(m.a)(e))})),!0},i._handleHiddenItems=function(t){if(!t.itemsGained)return!1;var e,n=!1,a=Object(j.a)(t.itemsGained);try{var o=function(){var t=e.value;if(!i.playerHasLooted(t)&&i.state.itemInfo[t]){n=!0;var a=i.state.itemInfo[t],o=new window.Image;o.src="images/".concat(a.id,".png"),o.onload=function(){i.setState(Object(b.a)(Object(b.a)({},i.state),{},{inventoryItems:[].concat(Object(m.a)(i.state.inventoryItems),[Object(b.a)(Object(b.a)({},a),{},{image:o})]),flags:[].concat(Object(m.a)(i.state.flags),["".concat(t,"_obtained")])}))}}};for(a.s();!(e=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}return n},i._handleRoomTransitions=function(t){var e=t.newRoom;return!!e&&(i.setState(Object(b.a)(Object(b.a)({},i.state),{},{room:e})),!0)},i._handleFlagsSet=function(t){var e,n=null===(e=t.flagsSet)||void 0===e?void 0:e.filter((function(t){return!i.state.flags.includes(t)}));return(null===n||void 0===n?void 0:n.length)>0&&(i.setState(Object(b.a)(Object(b.a)({},i.state),{},{flags:[].concat(Object(m.a)(i.state.flags),Object(m.a)(n))})),!0)},i._handleLocks=function(t){if(t.code){var e,n=t.unlocks.map((function(t){return"".concat(t,"_unlocked")})),a=Object(j.a)(n);try{for(a.s();!(e=a.n()).done;){var o=e.value;if(i.state.flags.includes(o))return}}catch(s){a.e(s)}finally{a.f()}i.setState(Object(b.a)(Object(b.a)({},i.state),{},{activeLock:{code:t.code,onUnlock:function(){i.setState(Object(b.a)(Object(b.a)({},i.state),{},{flags:[].concat(Object(m.a)(i.state.flags),Object(m.a)(n))}))}}}))}},i._getValidInteractions=function(t,e){var n;return null===t||void 0===t||null===(n=t.filter((function(t){return t.type===e})))||void 0===n?void 0:n.filter((function(t){return!t.requiredFlags||0===t.requiredFlags.filter((function(t){return!i.state.flags.includes(t)})).length}))},i._getImagePreviewUrl=function(t){var e="images/".concat(t,".png"),n=new Image;return n.src=e,0===n.width?"":e},i.reset=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";i.setState(Object(b.a)(Object(b.a)({},i.state),{},{imagePreviewUrl:i._getImagePreviewUrl(t),activeLock:{code:"",onUnlock:function(){}}}))},i.itemClickHandler=function(t){var e;i.reset(null===t||void 0===t?void 0:t.id);var n=!1;null===(e=i._getValidInteractions(t.interactions,"click"))||void 0===e||e.forEach((function(t){n=!0,i.setState(Object(b.a)(Object(b.a)({},i.state),{},{text:t.text})),i._handleHiddenItems(t),i._handleLostItems(t),i._handleFlagsSet(t),i._handleRoomTransitions(t),i._handleLocks(t)})),n||i.setState(Object(b.a)(Object(b.a)({},i.state),{},{text:t.description}))},i.logLastMouseUp=function(t,e){var n=e.x,a=e.y;i.setState(Object(b.a)(Object(b.a)({},i.state),{},{lastMouseUp:{itemId:t,x:n,y:a}}))},i.itemDragHandler=function(t,e){var n,a=e.x,o=e.y;i.reset();var s=!1;null===(n=i._getValidInteractions(t,"drag"))||void 0===n||n.forEach((function(t){t.target===i.state.lastMouseUp.itemId&&a===i.state.lastMouseUp.x&&o===i.state.lastMouseUp.y&&(i.setState(Object(b.a)(Object(b.a)({},i.state),{},{text:t.text})),s=!0,i._handleHiddenItems(t),i._handleLostItems(t),i._handleFlagsSet(t))})),s||i.setState(Object(b.a)(Object(b.a)({},i.state),{},{text:"Nothing happens."}))},i.combineItemsHandler=function(t,e){var n;i.reset();var a=!1;null===(n=i._getValidInteractions(t.interactions,"drag"))||void 0===n||n.forEach((function(t){t.target===e.id&&(i.setState(Object(b.a)(Object(b.a)({},i.state),{},{text:t.text})),a=!0,i._handleHiddenItems(t),i._handleLostItems(t),i._handleFlagsSet(t))})),a||i.setState(Object(b.a)(Object(b.a)({},i.state),{},{text:"Nothing happens."}))},i.state={maxInventorySlots:10,inventoryItems:[],usedItemIds:[],itemInfo:{},text:"",lastMouseUp:{itemId:null,x:0,y:0},room:i.props.defaultRoom,flags:[],imagePreviewUrl:"",activeLock:{code:"",onUnlock:function(){}}},i}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var t=this;w(this.props.itemsConfig).then((function(t){return t.text()})).then((function(e){t.setState((function(t){return Object(b.a)(Object(b.a)({},t),{},{itemInfo:O.a.parse(e)})}))}))}},{key:"playerHasLooted",value:function(t){return this.state.inventoryItems.map((function(t){return t.id})).includes(t)||this.state.usedItemIds.includes(t)}},{key:"render",value:function(){return Object(x.jsxs)("div",{className:"Game",children:[Object(x.jsxs)(f.f,{className:"canvas",width:"500",height:"1000",children:[Object(x.jsx)(k,{config:this.props.roomsConfig[this.state.room],bgImage:"".concat(this.state.room,".png"),onClick:this.itemClickHandler,onMouseUp:this.logLastMouseUp},this.state.room),Object(x.jsx)(y,{items:this.state.inventoryItems,maxInventorySlots:this.state.maxInventorySlots,onClick:this.itemClickHandler,onDragEnd:this.itemDragHandler,onCombineItems:this.combineItemsHandler})]}),Object(x.jsxs)("header",{className:"App-header",style:{display:"flex",flexDirection:"column"},children:[this.state.text,Object(x.jsx)("img",{src:this.state.imagePreviewUrl,alt:"",style:{width:"70%",marginTop:"20px"}}),Object(x.jsx)("div",{style:{color:"black",display:this.state.activeLock.code?"block":"none"},children:Object(x.jsx)(p.a,{combination:"".concat(this.state.activeLock.code),onMatch:this.state.activeLock.onUnlock,openText:"Unlocked!"})})]})]})}}]),n}(i.Component),C=(n(55),function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(){var t;Object(r.a)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a)))._renderGameLink=function(e){return Object(x.jsx)("li",{children:Object(x.jsx)(h.b,{id:e,to:"/point-and-click/".concat(e),children:t.props.gamesConfig[e].name})})},t}return Object(c.a)(n,[{key:"render",value:function(){return Object(x.jsxs)("nav",{role:"navigation",children:[Object(x.jsx)("b",{children:"Asukii's Adventure Game Maker"}),Object(x.jsxs)("ul",{children:[Object(x.jsx)("li",{children:Object(x.jsx)("a",{href:"/point-and-click",children:"Home"})}),Object(x.jsxs)("li",{children:[Object(x.jsx)("a",{children:"Games"}),Object(x.jsx)("ul",{children:Object.keys(this.props.gamesConfig).map(this._renderGameLink)})]}),Object(x.jsx)("li",{children:Object(x.jsx)("a",{href:"/point-and-click/contact",children:"Contact"})})]})]})}}]),n}(i.Component)),_=(n(61),n.p+"static/media/room1.8ab027f1.yaml"),L=n.p+"static/media/room2.c6fee66f.yaml",H={"demo-game":{name:"Demo Game",defaultRoom:"room1",itemsConfig:n.p+"static/media/items.69ffdaad.yaml",roomsConfig:{room1:_,room2:L}}},M=function(t){Object(l.a)(n,t);var e=Object(d.a)(n);function n(){return Object(r.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(x.jsxs)(h.a,{children:[Object(x.jsx)(C,{gamesConfig:H}),Object(x.jsx)("div",{className:"App",children:Object(x.jsxs)(u.c,{children:[Object(x.jsx)(u.a,{exact:!0,path:"/point-and-click",children:Object(x.jsx)(U,{})}),Object(x.jsx)(u.a,{exact:!0,path:"/point-and-click/contact",children:Object(x.jsx)(D,{})}),Object(x.jsx)(u.a,{path:"/point-and-click/:id",children:Object(x.jsx)(F,{})})]})})]})}}]),n}(i.Component);function U(){return Object(x.jsxs)("div",{className:"infopage",style:{color:"lightgrey",marginLeft:"25px"},children:[Object(x.jsx)("h3",{children:" What is this? "}),Object(x.jsx)("p",{children:'I\'m making a thing. For making adventure games. Like, your old school point-and-click style browser games. I guess you could call it a "game engine", but that makes it sound fancier than it is. \xaf\\_(\u30c4)_/\xaf'}),Object(x.jsxs)("p",{children:["I've got a short basic ",Object(x.jsx)(h.b,{id:"demo-game-body-embed",to:"demo-game",children:"demo game"})," up right now, which shows (most of) what you can do with this thing. For example:"]}),Object(x.jsxs)("ul",{children:[Object(x.jsxs)("li",{children:[" Clicking on stuff in rooms ",Object(x.jsx)("i",{children:"(wow!!)"})]}),Object(x.jsx)("li",{children:' Finding hidden objects, tracking inventory items, and auto-removing "spent" items '}),Object(x.jsx)("li",{children:" Combining inventory items together "}),Object(x.jsx)("li",{children:" Dragging-and-dropping inventory items onto specific spots in the room, to interact "}),Object(x.jsx)("li",{children:" Locking doors & other objects with either keys or numerical passcodes "}),Object(x.jsx)("li",{children:" Conditional game states - i.e. only do X if Y has happened first "}),Object(x.jsxs)("li",{children:[" Optional custom dialogue for any interactions (or combos of interactions) - including ones that ",Object(x.jsx)("i",{children:"don't"})," do anything"]})]}),Object(x.jsx)("h3",{children:"Can *I* make an adventure game using this, then?"}),Object(x.jsxs)("p",{children:["I mean, if you want, sure! You'll have to write some text* files formatted in a particular way, to set up things like \"when someone clicks on X, then Y should happen.\" While you don't have to know how to write code yourself to work with those text files, it ",Object(x.jsx)("i",{children:"would"})," probably make it a bit easier. If you're interested, let me know, and I'll get you some examples of how to format those text files in a way that the \"engine\" can understand -- then just send the results over to me, along with whatever images you want to use, and I'll happily get your game hosted on this site :)"]}),Object(x.jsxs)("p",{children:['If writing those config files from scratch is a bit too intimidating, I\'m also thinking about making a fancier "admin interface" at some point. Then, instead of needing to write the config text files by hand, you could click on things & fill out forms in a "game-maker-style" UI, which would then generate your config files for you & let you test the game as you build it. If you\'re interested at ',Object(x.jsx)("i",{children:"that"})," point, let me know, and I'll ping you when it's live :)"]}),Object(x.jsx)("small",{children:Object(x.jsx)("i",{children:"* to be pedantic, I'm using .YAML files, not .txt files, but whatever... close enough."})}),Object(x.jsx)("h3",{children:"Can I do [insert thing here] with your game maker?"}),Object(x.jsxs)("p",{children:["If you see it in the list of bullet points up above: ",Object(x.jsx)("b",{children:"YES!"})]}),Object(x.jsxs)("p",{children:["If you don't: ",Object(x.jsx)("b",{children:"STILL MAYBE!"})," I might just not have bothered to write it out explicitly. Feel free to ",Object(x.jsx)(h.b,{id:"contact-body-embed",to:"contact",children:"get in touch"}),": if it's possible, I'll happily walk you through how to do it, and if not, I'll happily take feature requests :)"]})]})}function D(){return Object(x.jsxs)("div",{className:"infopage",style:{color:"lightgrey",marginLeft:"25px"},children:[Object(x.jsx)("h3",{children:" Get in touch "}),Object(x.jsx)("p",{children:"If you're interested in creating a game in this engine, have feedback or feature requests, or just want to learn more in general, feel free to DM me anytime!"}),Object(x.jsx)("p",{children:Object(x.jsxs)("ul",{children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("b",{children:"Twitch:"})," ",Object(x.jsx)("a",{href:"https://twitch.tv/asukii314",children:"asukii314"})]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("b",{children:"Discord:"})," ",Object(x.jsx)("a",{href:"https://discord.gg/VWFmZMNCA4",children:"Join my server"}),", or DM me @asukii#7286"]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("b",{children:"Email:"})," ",Object(x.jsx)("a",{href:"mailto:asukii314.twitch@gmail.com",children:"asukii314.twitch@gmail.com"})]})]})})]})}function F(){var t=Object(u.f)().id;return H[t]?Object(x.jsx)(S,{defaultRoom:H[t].defaultRoom,itemsConfig:H[t].itemsConfig,roomsConfig:H[t].roomsConfig},t):Object(x.jsxs)("p",{style:{color:"white"},children:[Object(x.jsx)("b",{children:"404:"})," No game with that ID could be found."]})}var E=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,64)).then((function(e){var n=e.getCLS,i=e.getFID,a=e.getFCP,o=e.getLCP,s=e.getTTFB;n(t),i(t),a(t),o(t),s(t)}))};s.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(M,{})}),document.getElementById("root")),E()}},[[62,1,2]]]);
//# sourceMappingURL=main.9ad13eb5.chunk.js.map